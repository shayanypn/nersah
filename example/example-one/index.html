<!DOCTYPE html>
<html>
<head>
<title>Example One</title>
<script type="text/javascript" src="../../dist/nersah.js"></script>
<script type="text/javascript">
nersah.setDefault(
	{
		urlBase: 'https://api.thinghub.io',
		urlPrefix: '/v0',
		urlSuffix: '',

		timeout: 3000,

		dataType: 'json'
	},
	{
	200: function(http){
		console.log(' custom http handler : 200 ');
	},
	400: function(http){
		console.log(' custom http handler : 400 ');
	},
	500: function(http){
		console.log(' custom http handler : 500 ');
	}
});


var token;


nersah
.setTag('version')
.get('/')
.then(function(response){
	console.log( (new Date()).getTime() ,'app version' , response);
});


nersah
.setTag('login')
.post({
	url: '/token',
	data: JSON.stringify({
		mail: 'shayanypn@gmail.com',
		password: '1231231'
	})
})
.then(function(response){
	console.log( (new Date()).getTime() ,'login:' , response);
	token = response;
	// getProjects();
});
function getProjects(){
	nersah
	.get({
		url: '/user/'+token.user+'/organization-projects',
		headers:{
			'content-type': 'application/json',
			'Authorization': token.uuid
		}
	})
	.then(function(response){
		console.log('projects::' , response);
	});
}




nersah
.tag(['version','login']) 
.then(function(promises){
	console.info( (new Date()).getTime() , 'tags finish with success', promises);
},function(promises){
	console.error( (new Date()).getTime() , 'tags finish with failuare', promises);
})


</script>
</head>
<body>

</body>
</html>